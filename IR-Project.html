<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/logo.jpg"><link rel="icon" href="/img/logo.jpg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#01213a"><meta name="author" content="Wei He"><meta name="keywords" content="Computer Science and Technology, Machine Learning, Deep Learning, Computer Vision, Natural Language Processing"><meta name="description" content="「信息检索」课程项目，搭建一个简易的搜索引擎，检索主题为「文学」，实现过程中采用了网络爬虫 Larbin，Python 文档处理库 BeautifulSoup4，全文检索解决方案 Xunsearch。"><meta property="og:type" content="article"><meta property="og:title" content="IR课程项目-文学检索-开发文档"><meta property="og:url" content="https://hwcoder.top/IR-Project"><meta property="og:site_name" content="Hwcoder - Life Oriented Programming"><meta property="og:description" content="「信息检索」课程项目，搭建一个简易的搜索引擎，检索主题为「文学」，实现过程中采用了网络爬虫 Larbin，Python 文档处理库 BeautifulSoup4，全文检索解决方案 Xunsearch。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://hwcoder.top/img/home/IR-logo.png"><meta property="article:published_time" content="2021-08-25T10:15:04.000Z"><meta property="article:modified_time" content="2022-05-19T03:49:04.000Z"><meta property="article:author" content="Wei He"><meta property="article:tag" content="NLP"><meta property="article:tag" content="IR"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://hwcoder.top/img/home/IR-logo.png"><title>IR课程项目-文学检索-开发文档 | Hwcoder - Life Oriented Programming</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/mac.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"hwcoder.top",root:"/",version:"1.9.5",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h2, h3",placement:"left",visible:"always",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4",collapseDepth:3},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"XGNf4GEnaFLiUijMUvz8HSBF-gzGzoHsz",app_key:"JPeVLcug6EcWdBTpGrDJSdKi",server_url:"https://xgnf4gen.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml",include_content_in_search:!0};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","")})</script><meta name="generator" content="Hexo 5.4.2"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Hwcoder</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/bg/other.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="IR课程项目-文学检索-开发文档"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-08-25 18:15" pubdate>2021年8月25日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 5.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 31 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-right:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="项目经历" id="heading-b88758daa70ea87f4d698a4dac3c42fe" role="tab" data-toggle="collapse" href="#collapse-b88758daa70ea87f4d698a4dac3c42fe" aria-expanded="true">项目经历 <span class="list-group-count">(2)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-b88758daa70ea87f4d698a4dac3c42fe" role="tabpanel" aria-labelledby="heading-b88758daa70ea87f4d698a4dac3c42fe"><div class="category-post-list"><a href="/DB-Project" title="DB课程项目-校园食堂点餐系统-开发文档" class="list-group-item list-group-item-action"><span class="category-post">DB课程项目-校园食堂点餐系统-开发文档</span> </a><a href="/IR-Project" title="IR课程项目-文学检索-开发文档" class="list-group-item list-group-item-action active"><span class="category-post">IR课程项目-文学检索-开发文档</span></a></div></div></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">IR课程项目-文学检索-开发文档</h1><p class="note note-info">本文最后更新于：2022年5月19日 中午</p><div class="markdown-body"><p><img src="/img/blog/IR-Project-images/logo.png" srcset="/img/loading.gif" lazyload alt="logo" style="zoom:33%"></p><p><code>Date</code>：2021-08</p><p><code>Description</code>：本文档作为 2021 年夏季学期 IR 课程 Project 搜索引擎搭建的开发文档，检索主题为「<strong>文学</strong>」。</p><p><code>Reference</code>：参考自 CHH12 的 <a target="_blank" rel="noopener" href="https://gitee.com/CHH12/IR-project-pioneer-search">实现方案</a>，在其基础上改进了算法，适配了现版本工具并完善文档。</p><p><code>Copyleft</code>：© 2021 Hwcoder. Some rights reserved.</p><h2 id="系统说明">系统说明</h2><p>中国文学有数千年悠久历史，以特殊的内容、形式和风格构成了自己的特色，有自己的审美理想，有自己的起支配作用的思想文化传统和理论批判体系，是世界文学宝库中光彩夺目的瑰宝。</p><p>本搜索引擎主要收录了与<strong>中国文学</strong>有关的网页文档，包括但不限于民族文学、宗教文学、语言文学、诗词文学、中国外国文学等，爬取网站均来自中国社科院等官方机构。</p><h3 id="系统架构">系统架构</h3><figure><img src="/img/blog/IR-Project-images/system.png" srcset="/img/loading.gif" lazyload alt="系统架构"><figcaption aria-hidden="true">系统架构</figcaption></figure><p>本搜索引擎系统主要架构如上图所示。</p><p>检索的源文档由网络爬虫从给定的种子页面开始爬取，爬取到本地后利用 Python 中的 BeautifulSoup4 模块进行网页的解析，并写入文档数据库中。 之后利用搜索引擎解决方案 Xunsearch（迅搜）构建搜索引擎，利用索引器 Indexer 对文档数据进行索引，并构建基于 Xapian 的后端搜索服务器与前端的搜索应用，向用户展示出搜索功能。</p><h3 id="模块介绍">模块介绍</h3><h4 id="网络爬虫larbin">网络爬虫：Larbin</h4><p>Larbin 是一种开源的网络爬虫，用 C++ 语言实现。其设计简单，具有高度的可配置性，能够配置抓取深度、间隔、并发度、代理，并支持通过后缀名对抓取网页进行过滤。Larbin 具有非常高的效率，可以轻易获取单个网站的所有链接，自动扩展 url 页面并抓取与保存，从而为搜索引擎提供广泛的数据来源。</p><p>然而，Larbin 只是一个爬虫，<strong>只抓取网页</strong>，并不负责网页的解析、数据库的存储以及索引的建立，也不支持分布式系统。另外，Larbin 已经较长时间不再更新，因而不支持 https 协议，这在今天很大程度上造成了网页页面的局限性。</p><p>这里采用由国人在基于原版 Larbin2.6.3 版本上继续开发并发布于 GitHub 的 Larbin2.6.5 版本进行搜索引擎系统的构建。</p><p>项目网址：https://github.com/ictxiangxin/larbin</p><h4 id="网页解析beautifulsoup4-bs4">网页解析：BeautifulSoup4 (bs4)</h4><p>BeautifulSoup4 是一个可以从 HTML 或 XML 文件中提取数据的 Python 库。</p><p>由于 HTML 和 XML 文件本身是<strong>结构化的文本</strong>，有一定的规则，通过它的结构可以简化信息提取。类似的网页信息提取库还有 Lxml 和 Pyquery 等，但是 bs4 相比其他的库更加简单易用。</p><p>本项目就采用 BeautifulSoup4 快速对网页文档内容进行解析和格式化。</p><p>官方文档：https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/</p><h4 id="前端搜索引擎xunsearch-xapian">前端&amp;搜索引擎：Xunsearch &amp; Xapian</h4><p>Xunsearch（迅搜）是一款以 GPL 协议开源发布的高性能、全功能的<strong>全文检索</strong>解决方案，并针对<strong>中文</strong>深度优化和处理，用于帮助开发者针对海量数据快速建立搜索引擎。</p><p>Xunsearch 采用结构化分层设计，包含后端服务器和前端开发包两大部分。后端是用 C/C++ 基于 Xapian 搜索库、SCWS 中文分词、libevent 等开源库开发，借鉴了 nginx 的多进程多线程混合工作方式，是一个可承载高并发的高性能服务端。前端则是使用流行的脚本语言编写了开发工具包（SDK)。</p><p>本项目采用 Xunsearch 还考虑了以下特点：</p><ul><li>具有为搜索而自主开发 SCWS 中文分词库，支持复合分词、自定义补充词库，保障查全率、准确率。</li><li>索引接口齐全，索引添加简便，支持实时搜索，支持多种数据源（SQL、JSON、CSV 等）。</li><li>除通用搜索引擎功能外，还内置支持拼音检索、分面搜索、相关搜索、同义词搜索、搜索纠错建议等专业功能。</li></ul><p>官方地址：http://www.xunsearch.com/</p><p>此外，Xunsearch 的高速响应能力还离不开 Xapian 这一搜索引擎库。</p><p>Xapian 是一个允许开发人员轻易地添加<strong>高级索引和搜索功能</strong>到他们的应用系统的高度可修改的工具，它在支持概率论检索模型的同时也支持布尔型操作查询集。</p><p>Xapian 相比 Lucene 有更多的优势：基于 C++ 开发的强可移植性（可以运行在 Linux, MacOS, Windows 系统上），丰富的查询机制（概率性搜索排名、相关度反馈、邻近搜索、布尔搜索、词干提取、通配符查询、别名查询、拼写纠正等）和较强的检索性能。</p><h2 id="设计文档">设计文档</h2><h3 id="运行环境">运行环境</h3><p>主机：</p><ul><li>系统：Windows 10</li><li>带宽：40 Mbps</li></ul><p>虚拟机：</p><ul><li>软件：Oracle VM VirtualBox 6.1.26</li><li>配置设置：<ul><li>内存：2GB</li><li>磁盘：20GB</li><li>处理器：Intel(R) Core(TM) i5-9300H CPU @ 2.40GHz（核心数：1）</li></ul></li><li>系统：Linux Ubuntu 20.04</li><li>依赖环境：<ul><li>Apache 2.4.41</li><li>PHP 7.4.3</li><li>Python 3.8.10</li></ul></li></ul><h3 id="总体设计流程">总体设计流程</h3><ol type="1"><li>安装 Ubuntu 虚拟机，配置环境，安装 Larbin 和 Xunsearch。</li><li>配置 Larbin 爬虫选项，选定种子页面，爬取文档。</li><li>利用 BeautifulSoup4 模块编写脚本 Parser.py 解析文档，存储为 csv 文件。</li><li>生成 Xunsearch 配置文件，构建索引，生成搜索框架。</li><li>部署至 Apache HTTP Server，前后端代码再开发，优化搜索页面。</li></ol><h3 id="各模块设计细节">各模块设计细节</h3><h4 id="网络爬虫">网络爬虫</h4><p>网络爬虫模块使用 Larbin2.6.5 进行网页文档的爬取。在按照配置进行爬取 30 分钟后，最终获得 10965 个文档（约 409 MB）。由于爬虫自身的限制，这些文档均来自 http 站点。</p><p>以下是关键的配置项及说明：</p><ul><li>是否锁定种子站点：<strong>否</strong>。取消锁定才能根据链接爬取到更多内容。</li><li>是否使用扩展链接：<strong>否</strong>。大部分网页为了提高排名，都会引入无关的友链，由于本项目是专题检索，故关闭此功能避免进入其他域名。</li><li>同一个服务器的两次请求的间隔时间：<strong>无限制</strong>。通常基于礼貌原则，我们应该限制访问频率，但由于关闭了扩展链接，爬虫只会在少数域名中爬取，如果限制了间隔时间会使得爬取效率极低。</li><li>是否哈希页面以去重：<strong>是</strong>。由于站点固定，去重可以减少大量数据冗余。</li></ul><p>以下是种子网页地址：</p><ul><li>http://philosophychina.cssn.cn/ （中国哲学网-中国社科网子域名）</li><li>http://literature.cssn.cn/ （中国文学网-中国社科网子域名）</li><li>http://cel.cssn.cn/#story1 （中国民族文学网-中国社科网子域名）</li><li>http://ling.cssn.cn/ （中国语言文学网-中国社科网子域名）</li><li>http://iwr.cssn.cn/ （中国宗教文学网-中国社科网子域名）</li><li>http://ifl.cssn.cn （中国外国文学网-中国社科网子域名）</li><li>http://www.china-language.edu.cn/ （中国语言学网）</li><li>http://www.huaxiawen.com/ （华夏古代文学网）</li><li>http://www.zgwenxue.com/ （中国文学网）</li><li>http://www.eduwx.com/ （教育文学网）</li><li>http://www.wgwxzz.cn/ （外国文学网）</li><li>http://www.zhexue.org/ （哲学网）</li><li>http://www.52shici.cn/ （吾爱诗词网）</li></ul><p>在终端运行爬虫过程如下：</p><p><img src="/img/blog/IR-Project-images/Larbin1.png" srcset="/img/loading.gif" lazyload alt="Larbin运行过程" style="zoom:67%"></p><p>打开 localhost:8081 查看统计结果：</p><p><img src="/img/blog/IR-Project-images/Larbin2.png" srcset="/img/loading.gif" lazyload alt="Larbin运行结果" style="zoom:67%"></p><p>从统计结果可以看出，共收到 13783 个 URL，访问了 13783 个页面，最终成功爬取 10965 个页面。</p><p><img src="/img/blog/IR-Project-images/Larbin3.png" srcset="/img/loading.gif" lazyload alt="爬取速度变化" style="zoom:67%"></p><p>从上图可以具体地得出爬虫的爬取效率，可见爬虫爬取的速度随着时间的推移会发生较大的变化。</p><h4 id="网页解析">网页解析</h4><p>解析器模块利用 Python 的 BeautifulSoup4 和 Pandas 模块编写，前者可以对网页文档进行解析，后者便于将数据以 csv 文件形式保存，便于后续搜索引擎使用。</p><p>调用 BeautifulSoup4 的代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path + file, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    soup = BeautifulSoup(f.read(), <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>    <span class="hljs-keyword">if</span> soup.title == <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> soup.title.string == <span class="hljs-literal">None</span>:<br>        title.append(<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        title.append(soup.title.string.replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>))<br>    body.append(soup.get_text().replace(<span class="hljs-string">&#x27;\n&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>))<br></code></pre></td></tr></table></figure><p>调用 Pandas 的代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">data = &#123;<span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-built_in">id</span>, <span class="hljs-string">&#x27;title&#x27;</span>: title, <span class="hljs-string">&#x27;body&#x27;</span>: body, <span class="hljs-string">&#x27;urls&#x27;</span>: urls&#125;<br>frame = pd.DataFrame(data)<br><span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>:<br>    frame.to_csv(<span class="hljs-string">&#x27;data_u.csv&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8-sig&#x27;</span>, index=<span class="hljs-literal">False</span>)<br><span class="hljs-keyword">else</span>:<br>    frame.to_csv(<span class="hljs-string">&#x27;data_u.csv&#x27;</span>, mode=<span class="hljs-string">&#x27;a+&#x27;</span>, header=<span class="hljs-literal">False</span>, encoding=<span class="hljs-string">&#x27;utf-8-sig&#x27;</span>, index=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><p>处理结果如下：</p><p><img src="/img/blog/IR-Project-images/data.png" srcset="/img/loading.gif" lazyload alt="处理后的数据（部分）" style="zoom:67%"></p><p>可以看到每个文档被分出 id, title, body, urls 四个字段，存储在一个 csv 文件中。</p><h4 id="前端搜索引擎">前端&amp;搜索引擎</h4><p>搜索引擎模块利用 Xunsearch 提供的开发工具即可实现。首先确定运行环境正常，然后编写配置文件对格式化的 csv 文件建立索引，并生成搜索骨架代码，即可实现基本检索功能。</p><p>首先利用工具包中的 RequiredCheck 检查当前环境是否满足 Xunsearch 的运行条件：</p><p><img src="/img/blog/IR-Project-images/xun1.png" srcset="/img/loading.gif" lazyload alt="迅搜运行条件检查" style="zoom:50%"></p><p>环境正常后，利用工具包中的配置文件生成工具 IniWizzard，在 Web 交互页面中即可完成各个字段的设计：</p><p><img src="/img/blog/IR-Project-images/xun2.png" srcset="/img/loading.gif" lazyload alt="配置生成工具" style="zoom:50%"></p><p>其中，各个字段的含义如下：</p><ul><li>id 为主键，作为每个文档的标识符。</li><li>title 为文档的标题，赋予较高权重。</li><li>body 为文档的内容，截取 300 个字符作为搜索结果的摘要显示。</li><li>urls 作为每个文档在展示时的附属信息，不需要进行索引。</li></ul><p>此后，就可以用工具包中的索引管理器 Indexer 批量建立索引：</p><p><img src="/img/blog/IR-Project-images/xun3.png" srcset="/img/loading.gif" lazyload alt="批量建立索引" style="zoom:67%"></p><p>在 db 文件夹下，可以看到建立的索引文件：</p><p><img src="/img/blog/IR-Project-images/xun4.png" srcset="/img/loading.gif" lazyload alt="建立的索引文件" style="zoom:67%"></p><p>此时，可以用工具包中配备的测试工具 Quest，在当前索引中进行测试搜索，测试给定查询词的返回的数据。</p><p><img src="/img/blog/IR-Project-images/xun5.png" srcset="/img/loading.gif" lazyload alt="测试搜索" style="zoom:50%"></p><p>可以看到搜索功能已经可以使用了，这时需要用到工具包中的骨架代码生成工具 SearchSkel，生成前端代码。</p><p><img src="/img/blog/IR-Project-images/xun6.png" srcset="/img/loading.gif" lazyload alt="骨架代码生成" style="zoom:67%"></p><p>最后，运行 Apache2.0，将生成的 search 目录放到 /var/www/html 中，即可在本地服务器 localhost 访问搜索页面，实现搜索引擎的功能。</p><figure><img src="/img/blog/IR-Project-images/xun7.png" srcset="/img/loading.gif" lazyload alt="基础页面"><figcaption aria-hidden="true">基础页面</figcaption></figure><p>点击文档标题，会返回对应的文档主键（id）：</p><p><img src="/img/blog/IR-Project-images/xun8.png" srcset="/img/loading.gif" lazyload alt="点击标题后的弹框" style="zoom:67%"></p><h4 id="页面再开发">页面再开发</h4><p>可以看到，直接生成的框架文件有如下的不足：</p><ul><li>前端较为简陋，重点不够突出。</li><li>由于使用了国外的 cdn，访问速度较慢。</li><li>搜索结果点击后无法直接跳转至页面。</li></ul><p>开发 style.css 和 search.tpl 文件后，可以得到新的页面：</p><figure><img src="/img/blog/IR-Project-images/xun9.png" srcset="/img/loading.gif" lazyload alt="再开发后的页面"><figcaption aria-hidden="true">再开发后的页面</figcaption></figure><h2 id="页面展示">页面展示</h2><p>网站部署到 web 可访问目录后，可以通过虚拟机的端口转发设置，实现在主机上访问，也可以购买 HTTP 映射服务后在给定域名访问。这里选择最简单的在虚拟机中访问。</p><h3 id="首页">首页</h3><p>使用搜索前：</p><p><img src="/img/blog/IR-Project-images/page0.png" srcset="/img/loading.gif" lazyload alt="使用搜索前" style="zoom:67%"></p><p>使用搜索后：</p><p><img src="/img/blog/IR-Project-images/page1.png" srcset="/img/loading.gif" lazyload alt="使用搜索后" style="zoom:67%"></p><p>在使用了搜索功能后，搜索引擎将分析<strong>搜索日志</strong>，从而提供<strong>热门搜索词</strong>。 此外，可以看到搜索时可以选择多种方式，页脚有标明版权、处理时间以及作者的信息。</p><h3 id="搜索页面">搜索页面</h3><p>点击搜索后，会反馈查询结果的标题、文档摘要以及文档对应的原网址，并进行对查询词进行高亮表示（标题中红字、摘要中加粗），并会返回检索条目、检索时间、检索相似度等信息。</p><p>特别地，在页脚还提供了相关的搜索内容的联想，下图是在搜索「散文」后的联想：</p><p><img src="/img/blog/IR-Project-images/page2.png" srcset="/img/loading.gif" lazyload alt="相关搜索" style="zoom:67%"></p><h3 id="部分功能">部分功能</h3><ol type="1"><li>查询联想</li></ol><p><img src="/img/blog/IR-Project-images/page3.png" srcset="/img/loading.gif" lazyload alt="查询联想" style="zoom:67%"></p><ol start="2" type="1"><li>拼音联想</li></ol><p><img src="/img/blog/IR-Project-images/page4.png" srcset="/img/loading.gif" lazyload alt="拼音联想" style="zoom:67%"></p><ol start="3" type="1"><li>搜索纠错</li></ol><p><img src="/img/blog/IR-Project-images/page5.png" srcset="/img/loading.gif" lazyload alt="搜索纠错" style="zoom:67%"></p><ol start="4" type="1"><li>拼音纠错</li></ol><p><img src="/img/blog/IR-Project-images/page6.png" srcset="/img/loading.gif" lazyload alt="拼音纠错" style="zoom:67%"></p><ol start="5" type="1"><li>布尔检索</li></ol><p><img src="/img/blog/IR-Project-images/page7.png" srcset="/img/loading.gif" lazyload alt="未使用布尔检索的结果" style="zoom:67%"></p><p>插入否定连接词后：</p><p><img src="/img/blog/IR-Project-images/page8.png" srcset="/img/loading.gif" lazyload alt="插入布尔连接词后的结果" style="zoom:67%"></p><h2 id="性能评估">性能评估</h2><p>下表随机选取 10 个与本搜索引擎相关的查询词进行检索，评估搜索引擎的 Top5 查准率（precision@5）与平均响应时间（mean responding time）。</p><table><thead><tr class="header"><th style="text-align:center">查询</th><th style="text-align:center">查准率@5</th><th style="text-align:center">响应时间/s</th><th style="text-align:center">匹配文档总数</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">校园文学</td><td style="text-align:center">4</td><td style="text-align:center">0.0219</td><td style="text-align:center">2000</td></tr><tr class="even"><td style="text-align:center">宗教文学</td><td style="text-align:center">5</td><td style="text-align:center">0.0186</td><td style="text-align:center">1000</td></tr><tr class="odd"><td style="text-align:center">汉语</td><td style="text-align:center">5</td><td style="text-align:center">0.0210</td><td style="text-align:center">990</td></tr><tr class="even"><td style="text-align:center">藏语</td><td style="text-align:center">3</td><td style="text-align:center">0.0229</td><td style="text-align:center">68</td></tr><tr class="odd"><td style="text-align:center">季羡林</td><td style="text-align:center">1</td><td style="text-align:center">0.0173</td><td style="text-align:center">50</td></tr><tr class="even"><td style="text-align:center">鲁迅</td><td style="text-align:center">4</td><td style="text-align:center">0.0188</td><td style="text-align:center">501</td></tr><tr class="odd"><td style="text-align:center">毛泽东诗词</td><td style="text-align:center">5</td><td style="text-align:center">0.0221</td><td style="text-align:center">300</td></tr><tr class="even"><td style="text-align:center">马克思主义哲学中国化</td><td style="text-align:center">5</td><td style="text-align:center">0.0356</td><td style="text-align:center">100</td></tr><tr class="odd"><td style="text-align:center">散文作品</td><td style="text-align:center">4</td><td style="text-align:center">0.0128</td><td style="text-align:center">800</td></tr><tr class="even"><td style="text-align:center">小说集</td><td style="text-align:center">3</td><td style="text-align:center">0.0225</td><td style="text-align:center">120</td></tr></tbody></table><p>计算得：平均查准率为 3.9，平均响应时间为 0.02135s。</p><p>从结果上看，该搜索引擎在对应领域有着良好的表现，且响应迅速，但是对著名人物作品的查询则稍显不足。</p><p>此外，在部分检索结果中，有些无关文档由于重复出现了查询词而被赋予较高的「相似度」，但实际上 Top 10 返回结果的「相似度」都很高，可以考虑用 PageRank 等算法优化网站排名，提高 MRR 等指标。</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E9%A1%B9%E7%9B%AE%E7%BB%8F%E5%8E%86/" class="category-chain-item">项目经历</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/NLP/" class="print-no-link">#NLP</a> <a href="/tags/IR/" class="print-no-link">#IR</a></div></div><div class="license-box my-3"><div class="license-title"><div>IR课程项目-文学检索-开发文档</div><div>https://hwcoder.top/IR-Project</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Wei He</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2021年8月25日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/Mathematical-Logic" title="数理逻辑 应试笔记"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">数理逻辑 应试笔记</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/IR-Note-11" title="IR学习笔记 #11 问答系统"><span class="hidden-mobile">IR学习笔记 #11 问答系统</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"jdbBr3BddTiqSCPnXw6sXFv7-gzGzoHsz","appKey":"2bjgwDr2opjVCwhgjDMpk53c","path":"window.location.pathname","placeholder":"说点什么吧( •̀ ω •́ )✧","avatar":"retro","meta":["nick","mail","link"],"requiredFields":["nick"],"pageSize":10,"lang":"zh-CN","highlight":true,"recordIP":true,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;0<t.find(".toc-list-item").length&&t.css("visibility","visible")}}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>